# Bloob Haus Migration Plan: Hugo â†’ Eleventy

**Version:** 2.0  
**Date:** February 5, 2026  
**Status:** ðŸ“‹ PLANNING  
**Goal:** Migrate from Hugo to Eleventy using standard conventions

---

## Strategy Overview

**Parallel Migration:** Build Eleventy alongside Hugo (hugo/ stays intact until Phase M6)

**Key Decisions:**
- Standard Eleventy structure with `src/` as input directory
- Visualizers restructured for dual-use (build-time + browser)
- Backlinks via Eleventy's native collections (no JSON workaround)
- Documentation updates included as explicit phase

---

## Target Folder Structure

```
bloob-haus-webapp/
â”œâ”€â”€ .eleventy.js                 â† Config at root (Eleventy standard)
â”‚
â”œâ”€â”€ src/                         â† Eleventy source directory
â”‚   â”œâ”€â”€ _data/                   â† Global data files
â”‚   â”‚   â”œâ”€â”€ site.js              â† Site metadata (from hugo/config.yaml)
â”‚   â”‚   â””â”€â”€ eleventyComputed.js  â† Computed data (backlinks)
â”‚   â”‚
â”‚   â”œâ”€â”€ _includes/               â† Templates
â”‚   â”‚   â”œâ”€â”€ layouts/
â”‚   â”‚   â”‚   â”œâ”€â”€ base.njk         â† From hugo/layouts/_default/baseof.html
â”‚   â”‚   â”‚   â”œâ”€â”€ page.njk         â† From hugo/layouts/_default/single.html
â”‚   â”‚   â”‚   â””â”€â”€ list.njk         â† From hugo/layouts/_default/list.html
â”‚   â”‚   â””â”€â”€ partials/
â”‚   â”‚       â”œâ”€â”€ head.njk
â”‚   â”‚       â”œâ”€â”€ nav.njk
â”‚   â”‚       â””â”€â”€ backlinks.njk    â† NEW: displays backlinks
â”‚   â”‚
â”‚   â”œâ”€â”€ content/                 â† Generated by preprocessing (gitignored)
â”‚   â”‚
â”‚   â””â”€â”€ assets/                  â† Static assets
â”‚       â”œâ”€â”€ css/
â”‚       â”‚   â”œâ”€â”€ main.css
â”‚       â”‚   â””â”€â”€ visualizers/
â”‚       â””â”€â”€ js/
â”‚           â””â”€â”€ visualizers/     â† Bundled browser code
â”‚
â”œâ”€â”€ _site/                       â† Eleventy output (gitignored)
â”‚
â”œâ”€â”€ lib/                         â† Shared code (Bloob-specific)
â”‚   â””â”€â”€ visualizers/
â”‚       â”œâ”€â”€ README.md            â† Documents dual-use pattern
â”‚       â””â”€â”€ checkbox-tracker/
â”‚           â”œâ”€â”€ parser.js        â† Pure function: markdown â†’ data
â”‚           â”œâ”€â”€ renderer.js      â† Pure function: data â†’ HTML
â”‚           â”œâ”€â”€ browser.js       â† Browser-specific (DOM, localStorage)
â”‚           â”œâ”€â”€ styles.css
â”‚           â””â”€â”€ index.js         â† Exports
â”‚
â”œâ”€â”€ scripts/                     â† Build preprocessing (mostly unchanged)
â”‚   â”œâ”€â”€ clone-content.js         â† Keep as-is
â”‚   â”œâ”€â”€ preprocess-content.js    â† Modify output directory
â”‚   â”œâ”€â”€ build-site.js            â† Modify for Eleventy
â”‚   â”œâ”€â”€ bundle-visualizers.js    â† NEW: esbuild for browser bundles
â”‚   â””â”€â”€ utils/                   â† Keep all as-is
â”‚
â”œâ”€â”€ hugo/                        â† KEEP INTACT until Phase M6
â”‚
â”œâ”€â”€ content-source/              â† Cloned from GitHub (gitignored)
â”‚
â”œâ”€â”€ docs/
â”‚   â”œâ”€â”€ CLAUDE_CONTEXT.md        â† Update in Phase M7
â”‚   â”œâ”€â”€ architecture/
â”‚   â”‚   â””â”€â”€ visualizers.md       â† Update in Phase M7
â”‚   â””â”€â”€ implementation-plans/
â”‚       â”œâ”€â”€ DECISIONS.md         â† NEW: Document architectural decisions
â”‚       â””â”€â”€ ROADMAP.md           â† Update in Phase M7
â”‚
â”œâ”€â”€ plugins-for-obsidian/        â† Keep
â”œâ”€â”€ .env.example                 â† Keep
â”œâ”€â”€ .env.local                   â† Keep
â”œâ”€â”€ .gitignore                   â† Update
â”œâ”€â”€ package.json                 â† Update
â””â”€â”€ vercel.json                  â† Update in Phase M5
```

---

## Phase M0: Preparation

**Goal:** Set up directories and dependencies without breaking Hugo

**Time estimate:** 30 minutes

### Tasks

- [ ] **M0.1** Create directory structure
  ```bash
  mkdir -p src/{_data,_includes/layouts,_includes/partials,content,assets/css,assets/js}
  mkdir -p lib/visualizers/checkbox-tracker
  ```

- [ ] **M0.2** Install dependencies
  ```bash
  npm install @11ty/eleventy --save-dev
  npm install esbuild --save-dev
  ```

- [ ] **M0.3** Update `.gitignore`
  ```
  # Add these lines
  _site/
  src/content/
  ```

- [ ] **M0.4** Add npm scripts to `package.json`
  ```json
  {
    "scripts": {
      "build": "node scripts/build-site.js",
      "build:hugo": "node scripts/build-site.js --target=hugo",
      "build:eleventy": "node scripts/build-site.js --target=eleventy",
      "dev:eleventy": "npx @11ty/eleventy --serve",
      "eleventy": "npx @11ty/eleventy"
    }
  }
  ```

**Success Criteria:**
- `npm run dev:eleventy` starts (even if empty)
- `npm run build:hugo` still works (existing behavior)

---

## Phase M1: Eleventy Foundation

**Goal:** Get a basic Eleventy site rendering one markdown file

**Time estimate:** 2-3 hours

### Tasks

- [ ] **M1.1** Create `.eleventy.js` at project root
  
  ```javascript
  module.exports = function(eleventyConfig) {
    // Pass through static assets
    eleventyConfig.addPassthroughCopy("src/assets");
    
    // Watch for changes
    eleventyConfig.addWatchTarget("src/assets/");
    eleventyConfig.addWatchTarget("lib/");
    
    return {
      dir: {
        input: "src",
        includes: "_includes",
        data: "_data",
        output: "_site"
      },
      markdownTemplateEngine: "njk",
      htmlTemplateEngine: "njk"
    };
  };
  ```

- [ ] **M1.2** Create `src/_data/site.js`
  
  Reference `hugo/config.yaml` and convert to JS:
  ```javascript
  module.exports = {
    title: "Buff Baby Kitchen",
    description: "Vegan recipes from Buff Baby Bakery",
    url: process.env.SITE_URL || "https://buffbaby.bloob.haus",
    author: "Leon Santen"
  };
  ```

- [ ] **M1.3** Create `src/_includes/layouts/base.njk`
  
  Port from `hugo/layouts/_default/baseof.html`:
  
  | Hugo (Go templates) | Eleventy (Nunjucks) |
  |---------------------|---------------------|
  | `{{ .Title }}` | `{{ title }}` |
  | `{{ .Site.Title }}` | `{{ site.title }}` |
  | `{{ block "main" . }}{{ end }}` | `{{ content \| safe }}` |
  | `{{ partial "head.html" . }}` | `{% include "partials/head.njk" %}` |

- [ ] **M1.4** Create `src/_includes/layouts/page.njk`
  
  Port from `hugo/layouts/_default/single.html`

- [ ] **M1.5** Create `src/_includes/partials/head.njk`
  
  Port from `hugo/layouts/partials/head.html`

- [ ] **M1.6** Create `src/_includes/partials/nav.njk`
  
  Port from `hugo/layouts/partials/nav.html`

- [ ] **M1.7** Copy CSS
  ```bash
  cp -r hugo/assets/css/* src/assets/css/
  ```

- [ ] **M1.8** Create test file `src/content/test.md`
  ```markdown
  ---
  layout: layouts/page.njk
  title: Test Page
  ---
  
  # Hello from Eleventy
  
  This is a test page to verify the migration.
  ```

- [ ] **M1.9** Test build
  ```bash
  npm run eleventy
  npm run dev:eleventy
  # Visit http://localhost:8080/content/test/
  ```

**Success Criteria:**
- Test page renders with correct layout
- CSS loads correctly
- No build errors

---

## Phase M2: Preprocessing Integration

**Goal:** Connect existing preprocessing pipeline to Eleventy

**Time estimate:** 1-2 hours

### Tasks

- [ ] **M2.1** Modify `scripts/preprocess-content.js`
  
  Add target parameter at top of file:
  ```javascript
  const TARGET = process.env.BUILD_TARGET || 'hugo';
  
  const OUTPUT_DIRS = {
    hugo: {
      content: path.join(ROOT_DIR, 'hugo', 'content'),
      static: path.join(ROOT_DIR, 'hugo', 'static')
    },
    eleventy: {
      content: path.join(ROOT_DIR, 'src', 'content'),
      static: path.join(ROOT_DIR, 'src', 'assets', 'media')
    }
  };
  ```

- [ ] **M2.2** Modify frontmatter generation for Eleventy
  
  ```javascript
  // In the section that builds outputFrontmatter
  if (TARGET === 'eleventy') {
    outputFrontmatter.layout = 'layouts/page.njk';
  }
  ```

- [ ] **M2.3** Modify `scripts/build-site.js` for target flag
  
  ```javascript
  const args = process.argv.slice(2);
  const targetArg = args.find(a => a.startsWith('--target='));
  const target = targetArg ? targetArg.split('=')[1] : 'hugo';
  process.env.BUILD_TARGET = target;
  
  // ... rest of build script
  // At end, call eleventy instead of hugo if target is eleventy
  if (target === 'eleventy') {
    execSync('npx @11ty/eleventy', { stdio: 'inherit' });
  } else {
    execSync('npx hugo -s hugo', { stdio: 'inherit' });
  }
  ```

- [ ] **M2.4** Test full pipeline
  ```bash
  npm run build:eleventy
  ```

- [ ] **M2.5** Verify content structure
  ```bash
  ls -la src/content/
  # Should show preprocessed markdown files
  ```

**Success Criteria:**
- `npm run build:eleventy` runs complete pipeline
- Content appears in `src/content/`
- Media files in `src/assets/media/`
- Site builds and renders all pages

---

## Phase M3: Template Parity

**Goal:** Match Hugo's visual output exactly

**Time estimate:** 2-3 hours

### Tasks

- [ ] **M3.1** Create `src/_includes/layouts/list.njk`
  
  Port from `hugo/layouts/_default/list.html`
  
  Convert Hugo range to Eleventy:
  ```njk
  {# Hugo: {{ range .Pages }} #}
  {% for page in collections.all %}
    <a href="{{ page.url }}">{{ page.data.title }}</a>
  {% endfor %}
  ```

- [ ] **M3.2** Set up collections in `.eleventy.js`
  
  ```javascript
  // Collection of all recipes
  eleventyConfig.addCollection("recipes", function(collectionApi) {
    return collectionApi.getFilteredByGlob("src/content/recipes/**/*.md");
  });
  
  // Collection sorted by date
  eleventyConfig.addCollection("recipesByDate", function(collectionApi) {
    return collectionApi.getFilteredByGlob("src/content/recipes/**/*.md")
      .sort((a, b) => b.date - a.date);
  });
  ```

- [ ] **M3.3** Create homepage template
  
  Either update `src/content/index.njk` or create with collection loop

- [ ] **M3.4** Add date filter (if needed)
  
  ```javascript
  // In .eleventy.js
  eleventyConfig.addFilter("dateFormat", function(date, format) {
    return new Date(date).toLocaleDateString('en-US', {
      year: 'numeric', month: 'long', day: 'numeric'
    });
  });
  ```

- [ ] **M3.5** Visual comparison
  - Run both: `npm run build:hugo` and `npm run build:eleventy`
  - Compare in browser side-by-side
  - Note differences

- [ ] **M3.6** Fix styling/layout differences

**Success Criteria:**
- Homepage lists all recipes
- Recipe pages render correctly
- Navigation works
- Visual output matches Hugo

---

## Phase M4: Visualizer Architecture

**Goal:** Restructure checkbox-tracker for dual-use pattern

**Time estimate:** 2-3 hours

### Current Location
```
hugo/assets/js/visualizers/checkbox-tracker.js
hugo/assets/css/visualizers/checkbox-tracker.css
```

### New Location
```
lib/visualizers/checkbox-tracker/
â”œâ”€â”€ parser.js      â† Pure function: markdown â†’ data
â”œâ”€â”€ renderer.js    â† Pure function: data â†’ HTML string
â”œâ”€â”€ browser.js     â† Browser-specific (DOM events, localStorage)
â”œâ”€â”€ styles.css     â† Styling
â””â”€â”€ index.js       â† Exports
```

### Tasks

- [ ] **M4.1** Analyze existing checkbox-tracker
  
  Document:
  - What it parses (checkbox syntax)
  - What it outputs (interactive checkboxes)
  - Browser features (localStorage persistence)

- [ ] **M4.2** Create `lib/visualizers/checkbox-tracker/parser.js`
  
  ```javascript
  /**
   * Parse markdown to extract checkbox data
   * PURE FUNCTION - no side effects, no DOM, no fs
   * 
   * @param {string} markdown - Raw markdown content
   * @returns {Object} Structured checkbox data
   */
  export function parseCheckboxes(markdown) {
    const checkboxes = [];
    const regex = /- \[([ x])\] (.+)/g;
    let match;
    let id = 0;
    
    while ((match = regex.exec(markdown)) !== null) {
      checkboxes.push({
        id: `cb-${id++}`,
        checked: match[1] === 'x',
        label: match[2]
      });
    }
    
    return {
      checkboxes,
      stats: {
        total: checkboxes.length,
        checked: checkboxes.filter(c => c.checked).length
      }
    };
  }
  ```

- [ ] **M4.3** Create `lib/visualizers/checkbox-tracker/renderer.js`
  
  ```javascript
  /**
   * Render checkbox data to HTML string
   * PURE FUNCTION - returns string, no DOM manipulation
   * 
   * @param {Object} data - Output from parseCheckboxes
   * @param {Object} options - Rendering options
   * @returns {string} HTML string
   */
  export function renderCheckboxes(data, options = {}) {
    const { checkboxes, stats } = data;
    
    const progress = `
      <div class="checkbox-progress">
        ${stats.checked}/${stats.total} completed
      </div>
    `;
    
    const items = checkboxes.map(cb => `
      <label class="checkbox-item" data-id="${cb.id}">
        <input type="checkbox" ${cb.checked ? 'checked' : ''}>
        <span>${cb.label}</span>
      </label>
    `).join('\n');
    
    return `
      <div class="checkbox-tracker" data-visualizer="checkbox-tracker">
        ${progress}
        <div class="checkbox-list">
          ${items}
        </div>
      </div>
    `;
  }
  ```

- [ ] **M4.4** Create `lib/visualizers/checkbox-tracker/browser.js`
  
  ```javascript
  /**
   * Browser-specific functionality
   * THIS FILE HAS SIDE EFFECTS - DOM manipulation, localStorage
   */
  import { parseCheckboxes, renderCheckboxes } from './index.js';
  
  export function initCheckboxTracker(container) {
    const pageId = window.location.pathname;
    const storageKey = `checkbox-tracker:${pageId}`;
    
    // Load saved state from localStorage
    const savedState = JSON.parse(localStorage.getItem(storageKey) || '{}');
    
    // Add event listeners
    container.querySelectorAll('input[type="checkbox"]').forEach(checkbox => {
      const id = checkbox.closest('[data-id]').dataset.id;
      
      // Apply saved state
      if (savedState[id] !== undefined) {
        checkbox.checked = savedState[id];
      }
      
      // Save on change
      checkbox.addEventListener('change', () => {
        savedState[id] = checkbox.checked;
        localStorage.setItem(storageKey, JSON.stringify(savedState));
        updateProgress(container);
      });
    });
  }
  
  function updateProgress(container) {
    const checkboxes = container.querySelectorAll('input[type="checkbox"]');
    const checked = container.querySelectorAll('input[type="checkbox"]:checked');
    const progress = container.querySelector('.checkbox-progress');
    if (progress) {
      progress.textContent = `${checked.length}/${checkboxes.length} completed`;
    }
  }
  ```

- [ ] **M4.5** Create `lib/visualizers/checkbox-tracker/index.js`
  
  ```javascript
  export { parseCheckboxes } from './parser.js';
  export { renderCheckboxes } from './renderer.js';
  
  // Convenience: full transform
  export function transform(markdown, options) {
    const data = parseCheckboxes(markdown);
    return renderCheckboxes(data, options);
  }
  ```

- [ ] **M4.6** Copy and update styles
  ```bash
  cp hugo/assets/css/visualizers/checkbox-tracker.css lib/visualizers/checkbox-tracker/styles.css
  ```

- [ ] **M4.7** Create `scripts/bundle-visualizers.js`
  
  ```javascript
  const esbuild = require('esbuild');
  
  // Bundle browser code
  esbuild.build({
    entryPoints: ['lib/visualizers/checkbox-tracker/browser.js'],
    bundle: true,
    outfile: 'src/assets/js/visualizers/checkbox-tracker.js',
    format: 'iife',
    globalName: 'CheckboxTracker'
  }).catch(() => process.exit(1));
  ```

- [ ] **M4.8** Integrate with Eleventy
  
  Option A - As a filter:
  ```javascript
  // In .eleventy.js
  const { transform } = require('./lib/visualizers/checkbox-tracker');
  
  eleventyConfig.addFilter("checkboxTracker", function(content) {
    // Only transform if content has checkboxes
    if (content.includes('- [ ]') || content.includes('- [x]')) {
      return transform(content);
    }
    return content;
  });
  ```

- [ ] **M4.9** Add to build pipeline
  
  Update `package.json`:
  ```json
  {
    "scripts": {
      "bundle": "node scripts/bundle-visualizers.js",
      "build:eleventy": "npm run bundle && node scripts/build-site.js --target=eleventy"
    }
  }
  ```

- [ ] **M4.10** Test visualizer
  - Create test page with checkboxes
  - Verify build-time rendering
  - Verify browser interactivity
  - Verify localStorage persistence

**Success Criteria:**
- Visualizer code in `lib/visualizers/`
- Same code works at build-time and in browser
- Checkbox state persists across page loads
- Clear separation: parser (pure) / renderer (pure) / browser (side effects)

---

## Phase M5: Backlinks via Collections

**Goal:** Implement backlinks using Eleventy's native features

**Time estimate:** 1-2 hours

### Tasks

- [ ] **M5.1** Create `src/_data/eleventyComputed.js`
  
  ```javascript
  module.exports = {
    backlinks: function(data) {
      // This runs for each page during build
      // Access all pages via collections.all
      const currentUrl = data.page.url;
      const allPages = data.collections.all || [];
      
      // Find pages that link to this page
      return allPages.filter(page => {
        if (page.url === currentUrl) return false;
        const content = page.template?.inputContent || '';
        return content.includes(currentUrl) || 
               content.includes(data.page.fileSlug);
      }).map(page => ({
        url: page.url,
        title: page.data.title
      }));
    }
  };
  ```

- [ ] **M5.2** Alternative: Build link index in `.eleventy.js`
  
  ```javascript
  eleventyConfig.addCollection("withBacklinks", function(collectionApi) {
    const all = collectionApi.getAll();
    const linkMap = new Map();
    
    // First pass: extract all links from each page
    for (const page of all) {
      const content = page.template?.inputContent || '';
      const links = extractLinksFromContent(content);
      linkMap.set(page.url, links);
    }
    
    // Second pass: compute backlinks
    for (const page of all) {
      page.data.backlinks = all.filter(other => 
        linkMap.get(other.url)?.some(link => 
          link.includes(page.url) || link.includes(page.fileSlug)
        )
      ).map(p => ({ url: p.url, title: p.data.title }));
    }
    
    return all;
  });
  
  function extractLinksFromContent(content) {
    const links = [];
    // Match markdown links [text](url)
    const mdLinks = content.match(/\[([^\]]+)\]\(([^)]+)\)/g) || [];
    // Match wiki links [[target]]
    const wikiLinks = content.match(/\[\[([^\]]+)\]\]/g) || [];
    return [...mdLinks, ...wikiLinks];
  }
  ```

- [ ] **M5.3** Create `src/_includes/partials/backlinks.njk`
  
  ```njk
  {% if backlinks and backlinks.length > 0 %}
  <aside class="backlinks">
    <h3>Pages that link here</h3>
    <ul>
      {% for link in backlinks %}
      <li><a href="{{ link.url }}">{{ link.title }}</a></li>
      {% endfor %}
    </ul>
  </aside>
  {% endif %}
  ```

- [ ] **M5.4** Add backlinks to page layout
  
  In `src/_includes/layouts/page.njk`:
  ```njk
  {{ content | safe }}
  
  {% include "partials/backlinks.njk" %}
  ```

- [ ] **M5.5** Add backlinks styling to CSS

- [ ] **M5.6** Test backlinks
  - Ensure Recipe A links to Recipe B
  - Verify Recipe B shows backlink to Recipe A

**Success Criteria:**
- Backlinks computed automatically during build
- Backlinks display on pages that are linked to
- No JSON file workaround needed

---

## Phase M6: Deployment Switchover

**Goal:** Deploy Eleventy version to production

**Time estimate:** 1-2 hours

### Tasks

- [ ] **M6.1** Test complete build
  ```bash
  npm run build:eleventy
  npx serve _site
  # Manual testing of all pages
  ```

- [ ] **M6.2** Update `vercel.json`
  
  ```json
  {
    "buildCommand": "npm run build:eleventy",
    "outputDirectory": "_site",
    "framework": null
  }
  ```

- [ ] **M6.3** Push to branch for preview
  ```bash
  git checkout -b eleventy-migration
  git add .
  git commit -m "Migrate from Hugo to Eleventy"
  git push origin eleventy-migration
  ```

- [ ] **M6.4** Test Vercel preview deployment
  - Check preview URL
  - Verify all pages render
  - Verify all links work
  - Verify images load
  - Verify visualizers function

- [ ] **M6.5** Compare with production
  - Side-by-side comparison
  - Check for regressions

- [ ] **M6.6** Merge to main
  ```bash
  git checkout main
  git merge eleventy-migration
  git push origin main
  ```

- [ ] **M6.7** Verify production deployment

- [ ] **M6.8** Test webhook
  - Push change to buffbaby repo
  - Verify site rebuilds automatically

**Success Criteria:**
- buffbaby.bloob.haus serves Eleventy version
- Auto-rebuild on content changes works
- No visual regressions

---

## Phase M7: Cleanup & Documentation

**Goal:** Remove Hugo, update all documentation

**Time estimate:** 2-3 hours

### Tasks

#### Archive Hugo

- [ ] **M7.1** Create archive branch
  ```bash
  git checkout -b archive/hugo-version
  git push origin archive/hugo-version
  git checkout main
  ```

- [ ] **M7.2** Remove Hugo folder
  ```bash
  rm -rf hugo/
  git add -A
  git commit -m "Remove Hugo after successful Eleventy migration"
  ```

- [ ] **M7.3** Remove hugo-bin dependency
  ```bash
  npm uninstall hugo-bin
  ```

- [ ] **M7.4** Clean up package.json scripts
  
  Remove Hugo-specific scripts, keep only:
  ```json
  {
    "scripts": {
      "build": "npm run bundle && node scripts/build-site.js",
      "dev": "npx @11ty/eleventy --serve",
      "bundle": "node scripts/bundle-visualizers.js"
    }
  }
  ```

#### Update Documentation

- [ ] **M7.5** Create `docs/implementation-plans/DECISIONS.md`
  
  Document:
  - Why we migrated from Hugo to Eleventy
  - Visualizer dual-use architecture decision
  - Standard folder structure decision
  - Backlinks implementation choice
  
  (See template below)

- [ ] **M7.6** Update `docs/CLAUDE_CONTEXT.md`
  
  Checklist:
  - [ ] Change "Hugo" â†’ "Eleventy" throughout
  - [ ] Update folder structure diagram
  - [ ] Update build commands
  - [ ] Update "What's Working" section
  - [ ] Update file paths

- [ ] **M7.7** Update `docs/architecture/visualizers.md`
  
  Checklist:
  - [ ] Document dual-use pattern
  - [ ] Document `lib/visualizers/` structure
  - [ ] Add parser/renderer separation guidelines
  - [ ] Update code examples

- [ ] **M7.8** Update `docs/implementation-plans/ROADMAP.md`
  
  Checklist:
  - [ ] Mark migration as complete
  - [ ] Update Phase 2 for Eleventy context
  - [ ] Update any Hugo-specific references

- [ ] **M7.9** Update `.claude/` context files (if any)

- [ ] **M7.10** Update or create README.md

**Success Criteria:**
- Hugo folder removed from main
- Hugo preserved in archive branch
- All docs reflect current Eleventy architecture
- New developer could understand the project from docs

---

## DECISIONS.md Template

Create this file in Phase M7:

```markdown
# Bloob Haus Architectural Decisions

## Decision Log

### 2026-02-05: Migration from Hugo to Eleventy

**Context:**
Bloob Haus needed site-wide awareness for features like backlinks and spatial visualization.
The core vision is "visualizers that work both in the web app and in Obsidian."

**Decision:**
Migrate from Hugo to Eleventy.

**Rationale:**
1. **Code sharing:** Hugo uses Go templates; Eleventy uses JavaScript. Our preprocessing is already JS. Eleventy allows the same parsing logic to run at build-time and in browser.

2. **Native collections:** Eleventy provides site-wide data access without JSON file workarounds. Backlinks can be computed directly in config.

3. **Dual-use visualizers:** With JS throughout, visualizer code can be:
   - Run at build time (static HTML generation)
   - Run in browser (instant preview)
   - Potentially shared with Obsidian plugin

4. **User-friendly:** Standard Eleventy structure is recognizable to developers. Users who download their site will understand the layout.

**Trade-offs:**
- Slower builds than Hugo (~45s vs ~2s for 1000 pages)
- Migration effort (templates, config)
- Learning curve for Nunjucks templates

**Alternatives considered:**
- Stay with Hugo: Would require JSON workarounds for relational data
- Use Quartz: Obsidian-specific but heavy, less flexible

---

### 2026-02-05: Visualizer Dual-Use Architecture

**Context:**
Visualizers need to work in multiple contexts: static site generation, browser preview, and potentially Obsidian plugin.

**Decision:**
Structure all visualizers as:
- `parser.js` - Pure function: markdown â†’ structured data
- `renderer.js` - Pure function: data â†’ HTML string
- `browser.js` - Side effects: DOM events, localStorage
- `index.js` - Exports

**Rationale:**
1. **Testability:** Pure functions are easy to test
2. **Portability:** Same parser can run in Node.js, browser, or Obsidian
3. **Separation of concerns:** Build-time code has no DOM dependencies
4. **Future-proof:** Can add new renderers (e.g., for Obsidian) without changing parsers

**Rule:**
- Never put DOM operations in parser or renderer
- Never put file system operations in parser or renderer
- All side effects go in browser.js (or platform-specific file)

---

### 2026-02-05: Standard Eleventy Folder Structure

**Context:**
Users of Bloob Haus may download their generated site and customize it.

**Decision:**
Use standard Eleventy conventions:
- `src/` as input directory
- `_includes/`, `_data/` following Eleventy standards
- `_site/` as output

**Rationale:**
1. **Recognition:** Developers familiar with Eleventy will immediately understand the project
2. **Documentation:** Can point users to official Eleventy docs
3. **Ecosystem:** Compatible with Eleventy plugins and starters

**Non-standard additions:**
- `lib/visualizers/` - Shared code separate from Eleventy source
- `scripts/` - Build preprocessing (Bloob-specific)

These are clearly separated and documented.
```

---

## Quick Reference: Template Syntax Conversion

| Hugo (Go) | Eleventy (Nunjucks) |
|-----------|---------------------|
| `{{ .Title }}` | `{{ title }}` |
| `{{ .Content }}` | `{{ content \| safe }}` |
| `{{ .Date }}` | `{{ date }}` |
| `{{ .Permalink }}` | `{{ page.url }}` |
| `{{ .Site.Title }}` | `{{ site.title }}` |
| `{{ if .Param }}...{{ end }}` | `{% if param %}...{% endif %}` |
| `{{ range .Pages }}...{{ end }}` | `{% for page in collections.all %}...{% endfor %}` |
| `{{ partial "head.html" . }}` | `{% include "partials/head.njk" %}` |
| `{{ block "main" . }}{{ end }}` | `{% block main %}{% endblock %}` |

---

## Claude Code Session Template

When starting a Claude Code session:

```
I'm migrating Bloob Haus from Hugo to Eleventy.
Migration plan: docs/implementation-plans/hugo-to-eleventy-migration.md

Current phase: M[X]
Current task: M[X].[Y] - [task description]

Relevant files:
- Source (Hugo): hugo/[path]
- Target (Eleventy): src/[path]
- Lib: lib/[path]

Please help me [specific request].
```

---

## Rollback Plan

If issues arise after deployment:

1. Revert `vercel.json` to Hugo configuration
2. Push to main
3. Site automatically rebuilds with Hugo

Hugo folder is preserved until Phase M7, so rollback is always possible during migration.
